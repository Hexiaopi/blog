(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{687:function(t,e,a){t.exports=a.p+"assets/img/dirty-read.63ad1a9f.png"},688:function(t,e,a){t.exports=a.p+"assets/img/non-repeatable-read.12d910d1.png"},689:function(t,e,a){t.exports=a.p+"assets/img/phantom-read.a628a0a7.png"},690:function(t,e,a){t.exports=a.p+"assets/img/row-version.5584803d.png"},691:function(t,e,a){t.exports=a.p+"assets/img/read-view.da79f6a5.png"},757:function(t,e,a){"use strict";a.r(e);var s=a(11),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"äº‹åŠ¡çš„ç‰¹æ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡çš„ç‰¹æ€§"}},[t._v("#")]),t._v(" äº‹åŠ¡çš„ç‰¹æ€§")]),t._v(" "),s("ul",[s("li",[t._v("åŸå­æ€§(Atomicity): äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼ˆå›æ»šï¼‰ï¼Œä¸ä¼šåœ¨äº‹åŠ¡ä¸­é—´é‡åˆ°é”™è¯¯è€Œä¸­æ–­ã€‚")]),t._v(" "),s("li",[t._v("ä¸€è‡´æ€§(Consistency): äº‹åŠ¡å¼€å§‹å’Œç»“æŸæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€ï¼Œå³ç¬¦åˆçº¦æŸã€å®Œæ•´æ€§ã€é»˜è®¤å€¼ä»¥åŠå…¶å®ƒå®šä¹‰çš„è§„åˆ™ã€‚äº‹åŠ¡æ‰§è¡Œçš„ç»“æœä¸èƒ½ç ´åæ•°æ®åº“çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚")]),t._v(" "),s("li",[t._v("éš”ç¦»æ€§(Isolation): å„ä¸ªäº‹åŠ¡äº’ç›¸éš”ç¦»ï¼Œæ¯ä¸ªäº‹åŠ¡çš„æ‰§è¡Œéƒ½ä¸ä¼šå½±å“å…¶å®ƒäº‹åŠ¡çš„æ‰§è¡Œæˆ–è€…ç»“æœã€‚")]),t._v(" "),s("li",[t._v("æŒä¹…æ€§(Durability): ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤æˆåŠŸï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä½¿å‘ç”Ÿæ•°æ®åº“æ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶äº§ç”Ÿå½±å“ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"äº‹åŠ¡çš„å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡çš„å®ç°"}},[t._v("#")]),t._v(" äº‹åŠ¡çš„å®ç°")]),t._v(" "),s("ul",[s("li",[t._v("Undo logï¼šå®ç°äº‹åŠ¡çš„åŸå­æ€§ï¼›")]),t._v(" "),s("li",[t._v("Redo logï¼šå®ç°äº‹åŠ¡çš„æŒä¹…æ€§ï¼›")]),t._v(" "),s("li",[t._v("é”/MVCCï¼šå®ç°äº‹åŠ¡çš„éš”ç¦»æ€§ï¼›é”æœºåˆ¶æ¥ä¿è¯äº‹åŠ¡åœ¨æ‰§è¡Œæ—¶äº’ç›¸éš”ç¦»ï¼Œé˜²æ­¢äº‹åŠ¡é—´ç›¸äº’å¹²æ‰°ï¼Œå³å†™-å†™é—®é¢˜ã€‚MVCC æœºåˆ¶æ˜¯é€šè¿‡ä¿å­˜å†å²ç‰ˆæœ¬çš„æ–¹å¼æ¥å®ç°ï¼Œäº‹åŠ¡å¯ä»¥è¯»å–æ•°æ®åœ¨äº‹åŠ¡å¼€å§‹æ—¶çš„ç‰ˆæœ¬ï¼Œè€Œä¸å—åˆ°äº‹åŠ¡æœŸé—´å…¶ä»–äº‹åŠ¡æ‰€åšçš„æ”¹å˜çš„å½±å“ï¼Œå³å†™-è¯»é—®é¢˜ã€‚")]),t._v(" "),s("li",[t._v("ä»¥ä¸Šä¸‰è€…ä¿è¯äº†äº‹åŠ¡çš„ä¸€è‡´æ€§ï¼›")])]),t._v(" "),s("h2",{attrs:{id:"å¹¶å‘äº‹åŠ¡å¸¦æ¥çš„é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¹¶å‘äº‹åŠ¡å¸¦æ¥çš„é—®é¢˜"}},[t._v("#")]),t._v(" å¹¶å‘äº‹åŠ¡å¸¦æ¥çš„é—®é¢˜")]),t._v(" "),s("p",[t._v("å½“æ•°æ®åº“ä¸Šæœ‰å¤šä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°"),s("strong",[t._v("è„è¯»(dirty read)")]),t._v("ã€"),s("strong",[t._v("ä¸å¯é‡å¤è¯»(non-repeatable read)")]),t._v("ã€"),s("strong",[t._v("å¹»è¯»(phantom read)")]),t._v("ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå°±æœ‰äº†éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ")]),t._v(" "),s("h3",{attrs:{id:"è„è¯»é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è„è¯»é—®é¢˜"}},[t._v("#")]),t._v(" è„è¯»é—®é¢˜")]),t._v(" "),s("blockquote",[s("p",[t._v("è„è¯»æ˜¯æŒ‡ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­è®¿é—®åˆ°äº†å¦å¤–ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(687),alt:"dirty-read"}})]),t._v(" "),s("h3",{attrs:{id:"ä¸å¯é‡å¤è¯»é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸å¯é‡å¤è¯»é—®é¢˜"}},[t._v("#")]),t._v(" ä¸å¯é‡å¤è¯»é—®é¢˜")]),t._v(" "),s("blockquote",[s("p",[t._v("ä¸å¯é‡å¤è¯»æ˜¯æŒ‡ï¼šä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»å–åŒä¸€è¡Œæ•°æ®ï¼Œä½†æ˜¯åœ¨å¤šæ¬¡è¯»å–ä¸­æ•°æ®å‘ç”Ÿäº†æ”¹å˜ã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(688),alt:"non-repeatable-read"}})]),t._v(" "),s("h3",{attrs:{id:"å¹»è¯»é—®é¢˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¹»è¯»é—®é¢˜"}},[t._v("#")]),t._v(" å¹»è¯»é—®é¢˜")]),t._v(" "),s("blockquote",[s("p",[t._v("å¹»è¯»æ˜¯æŒ‡ï¼šä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡æ‰§è¡ŒåŒä¸€æ¡ SQL è¯­å¥ï¼Œä½†ç»“æœé›†å´ä¸åŒï¼Œå¯¼è‡´æ— æ³•æ”¯æ’‘åç»­çš„ä¸šåŠ¡æ“ä½œ")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(689),alt:"phantom-read"}})]),t._v(" "),s("h2",{attrs:{id:"äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"}},[t._v("#")]),t._v(" äº‹åŠ¡çš„éš”ç¦»çº§åˆ«")]),t._v(" "),s("p",[t._v("é’ˆå¯¹ä¸Šé¢ä¸‰ç§é—®é¢˜ï¼Œåˆ†åˆ«æœ‰å››ç§éš”ç¦»çº§åˆ«ï¼š")]),t._v(" "),s("h3",{attrs:{id:"æœªæäº¤è¯»-read-uncommitted-ru"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æœªæäº¤è¯»-read-uncommitted-ru"}},[t._v("#")]),t._v(" æœªæäº¤è¯»(read uncommittedï¼ŒRU)")]),t._v(" "),s("blockquote",[s("p",[t._v("æœªæäº¤è¯»ï¼Œæ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡è¿˜æœªæäº¤æ—¶ï¼Œå®ƒåšçš„å˜æ›´å°±èƒ½è¢«åˆ«çš„äº‹åŠ¡çœ‹åˆ°ã€‚å³"),s("strong",[t._v("æ²¡æœ‰æäº¤å´å¯ä»¥è¯»")])])]),t._v(" "),s("h3",{attrs:{id:"æäº¤è¯»-read-committed-rc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æäº¤è¯»-read-committed-rc"}},[t._v("#")]),t._v(" æäº¤è¯»(read committedï¼ŒRC)")]),t._v(" "),s("blockquote",[s("p",[t._v("æäº¤è¯»ï¼Œæ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡æäº¤ä¹‹åï¼Œå®ƒåšçš„å˜æ›´æ‰ä¼šè¢«å…¶ä»–äº‹åŠ¡çœ‹åˆ°ã€‚å³"),s("strong",[t._v("æäº¤æ‰å¯ä»¥è¯»")])])]),t._v(" "),s("p",[t._v("ğŸ‘€ "),s("strong",[t._v("å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«")])]),t._v(" "),s("h3",{attrs:{id:"å¯é‡å¤è¯»-repeatable-read-rr"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯é‡å¤è¯»-repeatable-read-rr"}},[t._v("#")]),t._v(" å¯é‡å¤è¯»(repeatable readï¼ŒRR)")]),t._v(" "),s("blockquote",[s("p",[t._v("å¯é‡å¤åº¦ï¼Œæ˜¯æŒ‡åŒä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å³åŒä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯·æ±‚è¯»å–æ•°æ®ï¼Œä¼šçœ‹åˆ°åŒæ ·çš„æ•°æ®è¡Œã€‚")])]),t._v(" "),s("p",[t._v("ğŸ‘€ "),s("strong",[t._v("MySQLçš„é»˜è®¤éš”ç¦»çº§åˆ«")])]),t._v(" "),s("h3",{attrs:{id:"ä¸²è¡ŒåŒ–-serializable-s"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸²è¡ŒåŒ–-serializable-s"}},[t._v("#")]),t._v(" ä¸²è¡ŒåŒ–(serializableï¼ŒS)")]),t._v(" "),s("blockquote",[s("p",[t._v("æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡æ’åºï¼Œä½¿ä¹‹ä¸å¯èƒ½ç›¸äº’å†²çªã€‚")]),t._v(" "),s("p",[t._v("è¿™ä¸ªçº§åˆ«å¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶ç°è±¡å’Œé”ç«äº‰ã€‚")])]),t._v(" "),s("p",[t._v("ä»¥ä¸Šå››ç§éš”ç¦»çº§åˆ«è§£å†³é—®é¢˜å¦‚ä¸‹ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("éš”ç¦»çº§åˆ«\\è§£å†³é—®é¢˜")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("è„è¯»")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("ä¸å¯é‡å¤è¯»")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("å¹»è¯»")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("å®ç°åŸç†")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("æœªæäº¤è¯»")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("æ²¡æœ‰è§†å›¾æ¦‚å¿µ")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("æäº¤è¯»")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("æ¯ä¸ªSQLè¯­å¥å¼€å§‹æ‰§è¡Œçš„æ—¶å€™åˆ›å»ºè§†å›¾")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("å¯é‡å¤è¯»")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âŒ")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡å¯åŠ¨æ—¶åˆ›å»ºè§†å›¾ï¼Œä¸”æ•´ä¸ªäº‹åŠ¡æœŸé—´éƒ½åœ¨ç”¨è¿™ä¸ªè§†å›¾")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("ä¸²è¡ŒåŒ–")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("âœ”ï¸")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("åŠ é”çš„æ–¹å¼é¿å…å¹¶è¡Œè®¿é—®")])])])]),t._v(" "),s("p",[t._v("å„ä¸ªéš”ç¦»çº§åˆ«éƒ½æœ‰å®ƒè‡ªå·±çš„ä½¿ç”¨åœºæ™¯ï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡æƒ…å†µæ¥å®šï¼Œéš”ç¦»çº§åˆ«ä»ä¸Šåˆ°ä¸‹ï¼Œæ€§èƒ½å˜å·®ã€‚")]),t._v(" "),s("h2",{attrs:{id:"mvcc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mvcc"}},[t._v("#")]),t._v(" MVCC")]),t._v(" "),s("p",[t._v("MySQL InnoDBé»˜è®¤çº§åˆ«æ˜¯å¯é‡å¤åº¦éš”ç¦»çº§åˆ«ï¼Œä¸ºäº†è§£å†³ä¸å¯é‡å¤è¯»é—®é¢˜ï¼ŒInnoDBé‡‡ç”¨äº†MVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)çš„æ–¹å¼ã€‚å®ƒä¸ºå­˜å‚¨çš„æ¯ä¸€è¡Œå¢åŠ ä¸‰ä¸ªé¢å¤–çš„éšè—å­—æ®µ")]),t._v(" "),s("ul",[s("li",[t._v("DATA_TRX_IDï¼šäº§ç”Ÿå½“å‰è®°å½•é¡¹çš„äº‹åŠ¡ID")]),t._v(" "),s("li",[t._v("DELETE BITï¼šç”¨äºæ ‡è¯†è¯¥è®°å½•æ˜¯å¦æ˜¯åˆ é™¤è®°å½•")]),t._v(" "),s("li",[t._v("DATA_ROLL_PTRï¼šæŒ‡å‘å½“å‰è®°å½•é¡¹çš„undoä¿¡æ¯")])]),t._v(" "),s("h3",{attrs:{id:"mvccä¸‹sqlè¯­å¥å®é™…å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mvccä¸‹sqlè¯­å¥å®é™…å¤„ç†"}},[t._v("#")]),t._v(" MVCCä¸‹SQLè¯­å¥å®é™…å¤„ç†")]),t._v(" "),s("h4",{attrs:{id:"select"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#select"}},[t._v("#")]),t._v(" SELECT")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("InnoDBåªæŸ¥æ‰¾ç‰ˆæœ¬æ—©äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬çš„æ•°æ®è¡Œï¼ˆè¡Œçš„äº‹åŠ¡ç‰ˆæœ¬å·<=å½“å‰äº‹åŠ¡çš„ç³»ç»Ÿç‰ˆæœ¬å·ï¼‰ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº‹åŠ¡è¯»å–çš„è¡Œï¼Œè¦ä¹ˆæ˜¯åœ¨äº‹åŠ¡å¼€å§‹å‰ä»¥åŠå­˜åœ¨ï¼Œè¦ä¹ˆæ˜¯äº‹åŠ¡è‡ªèº«æ’å…¥æˆ–è€…ä¿®æ”¹è¿‡çš„ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("è¡Œçš„åˆ é™¤ç‰ˆæœ¬è¦ä¹ˆæœªå®šä¹‰ï¼Œè¦ä¹ˆå¤§äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿äº‹åŠ¡è¯»å–åˆ°çš„è¡Œï¼Œåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰æœªè¢«åˆ é™¤ã€‚")])])]),t._v(" "),s("blockquote",[s("p",[t._v("åªæœ‰ç¬¦åˆä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶çš„è®°å½•ï¼Œæ‰èƒ½è¿”å›ä½œä¸ºæŸ¥è¯¢ç»“æœ")])]),t._v(" "),s("h4",{attrs:{id:"insert"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#insert"}},[t._v("#")]),t._v(" INSERT")]),t._v(" "),s("blockquote",[s("p",[t._v("InnoDBä¸ºæ–°æ’å…¥çš„æ¯ä¸€è¡Œä¿å­˜å½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ä½œä¸ºè¡Œç‰ˆæœ¬å·")])]),t._v(" "),s("h4",{attrs:{id:"delete"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete"}},[t._v("#")]),t._v(" DELETE")]),t._v(" "),s("blockquote",[s("p",[t._v("InnoDBä¸ºåˆ é™¤çš„æ¯ä¸€è¡Œä¿å­˜å½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ä½œä¸ºè¡Œåˆ é™¤æ ‡è¯†")])]),t._v(" "),s("h4",{attrs:{id:"update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update"}},[t._v("#")]),t._v(" UPDATE")]),t._v(" "),s("blockquote",[s("p",[t._v("InnoDBä¸ºæ’å…¥ä¸€è¡Œæ–°è®°å½•ï¼Œä¿å­˜å½“å‰äº‹åŠ¡ç‰ˆæœ¬ä½œä¸ºè¡Œç‰ˆæœ¬å·ï¼ŒåŒæ—¶ä¿å­˜å½“å‰äº‹åŠ¡ç‰ˆæœ¬å·åˆ°åŸæ¥çš„è¡Œä½œä¸ºè¡Œåˆ é™¤æ ‡è¯†")])]),t._v(" "),s("p",[t._v("MVCCå¤šç‰ˆæœ¬åœ¨äº‹åŠ¡å¯åŠ¨æ—¶ç”¨åˆ°"),s("strong",[t._v("ä¸€è‡´æ€§è¯»è§†å›¾(consisten read view)")]),t._v("ï¼Œé‚£ä»€ä¹ˆæ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§è§†å›¾å‘¢ï¼Ÿ")]),t._v(" "),s("p",[t._v("InnoDBæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰å”¯ä¸€çš„äº‹åŠ¡ID(transaction id)ï¼Œå®ƒåœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™å‘InnoDBçš„äº‹åŠ¡ç³»ç»Ÿç”³è¯·çš„ï¼Œæ˜¯ä¸¥æ ¼æŒ‰ç…§é€’å¢çš„é¡ºåºç”³è¯·çš„ã€‚")]),t._v(" "),s("p",[t._v("æ¯è¡Œæ•°æ®ä¹Ÿéƒ½æ˜¯æœ‰å¤šä¸ªç‰ˆæœ¬çš„ï¼Œæ¯æ¬¡äº‹åŠ¡æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®ç‰ˆæœ¬ï¼Œå¹¶ä¸”å°†äº‹åŠ¡IDèµ‹å€¼ç»™è¿™ä¸ªæ•°æ®ç‰ˆæœ¬çš„äº‹åŠ¡IDï¼ŒåŒæ—¶æ—§çš„æ•°æ®ç‰ˆæœ¬è¦ä¿ç•™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:a(690),alt:"è¡Œ-ç‰ˆæœ¬"}})]),t._v(" "),s("p",[t._v("å›¾ä¸­è™šçº¿æ¡†ä¸­åŒä¸€è¡Œæ•°æ®æœ‰4ä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬å‡æœ‰å¯¹åº”çš„äº‹åŠ¡IDã€‚")]),t._v(" "),s("p",[t._v("InnoDBä¸ºæ¯ä¸ªäº‹åŠ¡æ„é€ äº†ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥ä¿å­˜è¿™ä¸ªäº‹åŠ¡å¯åŠ¨ç¬é—´ï¼Œå½“å‰æ­£åœ¨"),s("strong",[t._v("æ´»è·ƒ")]),t._v("ï¼ˆå¯åŠ¨è¿˜ä¸ºæäº¤ï¼‰çš„æ‰€æœ‰äº‹åŠ¡IDï¼Œæ•°ç»„é‡Œé¢äº‹åŠ¡IDçš„æœ€å°å€¼è®°ä¸º"),s("strong",[t._v("ä½æ°´ä½")]),t._v("ï¼Œäº‹åŠ¡IDçš„æœ€å¤§å€¼+1è®°ä¸º"),s("strong",[t._v("é«˜æ°´ä½")]),t._v("ã€‚è¿™ä¸ªè§†å›¾æ•°ç»„å’Œé«˜æ°´ä½å°±ç»„æˆäº†å½“å‰äº‹åŠ¡çš„ä¸€è‡´æ€§è§†å›¾ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:a(691),alt:"è§†å›¾"}})]),t._v(" "),s("p",[t._v("å¯¹äºæ•°æ®ç‰ˆæœ¬çš„äº‹åŠ¡IDï¼Œåˆ™å­˜åœ¨ä»¥ä¸‹æƒ…å†µï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœè½åœ¨ç»¿è‰²éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯å·²æäº¤äº‹åŠ¡æˆ–è€…å½“å‰äº‹åŠ¡è‡ªå·±ç”Ÿæˆçš„ï¼Œè¿™ä¸ªç‰ˆæœ¬æ•°æ®æ˜¯å¯è§çš„ï¼›")]),t._v(" "),s("li",[t._v("å¦‚æœè½åœ¨çº¢è‰²éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±å°†æ¥å¯åŠ¨çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œåˆ™ä¸å¯è§ï¼›")]),t._v(" "),s("li",[t._v("å¦‚æœè½åœ¨é»„è‰²éƒ¨åˆ†ï¼Œå­˜åœ¨ä¸¤ç§æƒ…å†µ\n"),s("ul",[s("li",[t._v("è‹¥row trx_idåœ¨æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±"),s("strong",[t._v("è¿˜æœªæäº¤çš„äº‹åŠ¡")]),t._v("ç”Ÿæˆçš„ï¼Œè¿™ä¸ªç‰ˆæœ¬æ•°æ®æ˜¯ä¸å¯è§çš„ï¼›")]),t._v(" "),s("li",[t._v("è‹¥row trx_idä¸åœ¨æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±"),s("strong",[t._v("å·²ç»æäº¤çš„äº‹åŠ¡")]),t._v("ç”Ÿæˆçš„ï¼Œè¿™ä¸ªç‰ˆæœ¬æ•°æ®æ˜¯å¯è§çš„ï¼›")])])])]),t._v(" "),s("p",[t._v("ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("primary")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("engine")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("æˆ‘ä»¬ä»¥"),s("strong",[t._v("å¯é‡å¤è¯»éš”ç¦»çº§åˆ«")]),t._v("ä¸ºä¾‹ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡A")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡B")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡C")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction with consistent snapshot;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction with consistent snapshot;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("update t set k=k+1 where id=1;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("update t set k=k+1 where id=1;  "),s("br"),t._v("select k from t where id =1;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select k from t where id=1;"),s("br"),t._v("commit;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("p",[t._v("è¿™é‡Œæ³¨æ„ï¼š")]),t._v(" "),s("p",[s("code",[t._v("begin/start transaction")]),t._v(" å‘½ä»¤å¹¶ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„èµ·ç‚¹ï¼Œåœ¨æ‰§è¡Œåˆ°å®ƒä»¬ä¹‹åçš„ç¬¬ä¸€ä¸ªæ“ä½œ InnoDB è¡¨çš„è¯­å¥ï¼Œäº‹åŠ¡æ‰çœŸæ­£å¯åŠ¨ã€‚å¦‚æœä½ æƒ³è¦é©¬ä¸Šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ "),s("code",[t._v("start transaction with consistent snapshot")]),t._v("è¿™ä¸ªå‘½ä»¤ã€‚")]),t._v(" "),s("p",[t._v("è¿™é‡Œæˆ‘ä»¬å‡è®¾äº‹åŠ¡Aã€Bã€Cçš„ç‰ˆæœ¬å·åˆ†åˆ«æ˜¯100ã€101ã€102ã€‚")]),t._v(" "),s("p",[t._v("id=1è¿™è¡Œæ•°æ®å­˜åœ¨ä»¥ä¸‹ç‰ˆæœ¬ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡ID")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("90ï¼ˆå†å²äº‹åŠ¡IDï¼‰")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("102")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("101")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("å€¼")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("3")])])])]),t._v(" "),s("p",[t._v("äº‹åŠ¡AæŸ¥è¯¢çš„æ—¶å€™ï¼Œäº‹åŠ¡Bè¿˜æ²¡æœ‰æäº¤ï¼Œå› æ­¤3ä¸å¯è§ã€‚äº‹åŠ¡Cè™½ç„¶æäº¤äº†ï¼Œä½†æ˜¯äº‹åŠ¡Aå¯åŠ¨æ—¶ï¼Œå°±åˆ›å»ºäº†ä¸€è‡´æ€§è§†å›¾ï¼Œå¯¹äºäº‹åŠ¡Aæ¥è¯´ï¼Œå®ƒçš„è§†å›¾æ•°ç»„æ˜¯[99,100]ï¼Œä¾æ—§ä¸å¯è§ã€‚")]),t._v(" "),s("p",[t._v("å¯¹äºäº‹åŠ¡ä¸€è‡´æ€§è§†å›¾æ¥è¯´ï¼Œé™¤äº†è‡ªå·±çš„æ›´æ–°æ€»æ˜¯å¯è§ä»¥ä¸ºï¼Œè¿˜æœ‰ä¸‰ç§æƒ…å†µï¼š")]),t._v(" "),s("ol",[s("li",[t._v("ç‰ˆæœ¬æœªæäº¤ï¼Œä¸å¯è§ï¼›")]),t._v(" "),s("li",[t._v("ç‰ˆæœ¬å·²æäº¤ï¼Œä½†æ˜¯æ˜¯åœ¨è§†å›¾åˆ›å»ºåæäº¤çš„ï¼Œä¸å¯è§ã€‚")]),t._v(" "),s("li",[t._v("ç‰ˆæœ¬å·²æäº¤ï¼Œè€Œä¸”æ˜¯åœ¨è§†å›¾å‰æäº¤çš„ï¼Œå¯è§ã€‚")])]),t._v(" "),s("p",[t._v("é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œäº‹åŠ¡Bæ›´æ–°çš„æ—¶å€™ï¼Œå¦‚æœæŒ‰ç…§ä¸€è‡´æ€§è§†å›¾ï¼Œä¸åº”è¯¥æ›´æ–°k=3å‘€ï¼Œè¿™é‡Œå°±éœ€è¦ä¸€æ¡è§„åˆ™ï¼š"),s("strong",[t._v("æ›´æ–°æ•°æ®éƒ½æ˜¯å…ˆè¯»åå†™")]),t._v("ï¼Œè¿™ä¸ªè¯»è¦å±äº"),s("strong",[t._v("å½“å‰è¯»")]),t._v("ï¼Œå¦åˆ™äº‹åŠ¡Cå°±ä¸ç”Ÿæ•ˆäº†ã€‚")]),t._v(" "),s("p",[t._v("è¯»å­˜åœ¨ä¸¤ç§è¯»ï¼š"),s("strong",[t._v("å½“å‰è¯»")]),t._v("å’Œ"),s("strong",[t._v("å¿«ç…§è¯»")]),t._v("ã€‚")]),t._v(" "),s("h3",{attrs:{id:"å¿«ç…§è¯»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¿«ç…§è¯»"}},[t._v("#")]),t._v(" å¿«ç…§è¯»")]),t._v(" "),s("blockquote",[s("p",[t._v("è¯»å–çš„æ˜¯è®°å½•çš„å¯è§ç‰ˆæœ¬ï¼Œä¸ç”¨åŠ é”")])]),t._v(" "),s("p",[t._v("ç®€å•çš„selectæ“ä½œï¼Œå±äºå¿«ç…§è¯»ï¼Œä¾‹å¦‚ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ?ï¼›\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"å½“å‰è¯»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å½“å‰è¯»"}},[t._v("#")]),t._v(" å½“å‰è¯»")]),t._v(" "),s("p",[s("strong",[t._v("å¹»è¯»åœ¨å½“å‰è¯»æ‰æœ‰å¯èƒ½å‡ºç°")]),t._v("ï¼Œé‚£ä¹ˆInnodbæ˜¯å¦‚ä½•é˜²æ­¢å¹»è¯»çš„å‘¢ï¼Œinnodbæä¾›äº†ä¸€ä¸ªé—´éš™é”çš„æŠ€æœ¯ï¼Œè¡Œæ•°ç»“åˆé—´éš™é”ï¼Œè¾¾åˆ°æœ€ç»ˆç›®çš„ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("è¯»å–çš„æ˜¯è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”ï¼Œå½“å‰è¯»è¿”å›çš„è®°å½•ï¼Œéƒ½ä¼šåŠ ä¸Šé”ï¼Œä¿è¯å…¶ä»–äº‹åŠ¡ä¸ä¼šå†å¹¶å‘ä¿®æ”¹è¿™æ¡è®°å½•ã€‚")])]),t._v(" "),s("p",[t._v("ç‰¹æ®Šçš„è¯»æ“ä½œï¼Œä»¥åŠæ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ“ä½œéƒ½å±äºå½“å‰è¯»ï¼Œä¾‹å¦‚ï¼š")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ? "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lock")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("share")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ? "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" ? "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ?"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" ?"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("æˆ‘ä»¬ä»¥"),s("strong",[t._v("è¯»æäº¤éš”ç¦»çº§åˆ«")]),t._v("ä¸ºä¾‹ï¼š")]),t._v(" "),s("p",[t._v("ç”±äº"),s("code",[t._v("start transaction with consistent snapshot;")]),t._v("åœ¨è¯»æäº¤éš”ç¦»çº§åˆ«ä¸‹æ²¡æœ‰æ„ä¹‰ï¼Œç­‰ä»·äºæ™®é€šçš„"),s("code",[t._v("start transaction")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡A")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡B")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡C")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("update t set k=k+1 where id=1;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("update t set k=k+1 where id=1;  "),s("br"),t._v("select k from t where id =1;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select k from t where id=1;"),s("br"),t._v("commit;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("p",[t._v("äº‹åŠ¡Aåœ¨æ‰§è¡Œ"),s("code",[t._v("select k from t where id=1;")]),t._v("æ‰åˆ›å»ºä¸€è‡´æ€§è§†å›¾ï¼Œæ­¤æ—¶äº‹åŠ¡Cå·²æäº¤ï¼Œå› æ­¤k=2;")]),t._v(" "),s("p",[t._v("åŒæ ·äº‹åŠ¡Bï¼Œäº‹åŠ¡Cå·²æäº¤ï¼Œå› æ­¤å¯è§ï¼Œä¸”è‡ªå·±ä¿®æ”¹çš„è‚¯å®šå¯è§ï¼Œå› æ­¤k=3;")]),t._v(" "),s("h2",{attrs:{id:"é‚£ä¹ˆmysqlå¯é‡å¤è¯»è§£å†³å¹»è¯»äº†å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é‚£ä¹ˆmysqlå¯é‡å¤è¯»è§£å†³å¹»è¯»äº†å—"}},[t._v("#")]),t._v(" é‚£ä¹ˆMySQLå¯é‡å¤è¯»è§£å†³å¹»è¯»äº†å—ï¼Ÿ")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬è¯•éªŒä¸ºä¾‹ï¼š")]),t._v(" "),s("p",[t._v("å‡è®¾å­˜åœ¨è¡¨"),s("code",[t._v("dept")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" desc dept"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+-------+-------------+------+-----+---------+-------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Field "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Type        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Null "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Default "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Extra "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+-------+-------------+------+-----+---------+-------+\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" int"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" NO   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" PRI "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" NULL    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" varchar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" YES  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+-------+-------------+------+-----+---------+-------+\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" rows "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00")]),t._v(" sec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("å¼€å¯ä¸¤ä¸ªäº‹åŠ¡è¿›è¡Œè¯•éªŒ")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡A")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡B")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("Empty set (0.01 sec)")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("insert into dept values(1,'a');")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("Empty set (0.01 sec)")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("Empty set (0.01 sec)")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("insert into dept values(1,'a');"),s("br"),t._v("Duplicate entry '1' for key 'PRIMARY'")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("p",[t._v("äº‹åŠ¡Aå°±å¾ˆå¥‡æ€ªï¼Œæ˜æ˜æŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œå†™å…¥æ—¶å´æŠ¥ä¸»é”®é‡å¤é”™è¯¯ğŸ˜¢("),s("strong",[t._v("å¹»è¯»å‡ºç°")]),t._v(")")]),t._v(" "),s("p",[t._v("ç»§ç»­è¯•éªŒï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡A")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡B")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("1,a")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("insert into dept values(2,'b');")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("1,a")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("1,a")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("update dept set value='z';"),s("br"),t._v("Query OK, 2 rows affected (0.00 sec)")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("p",[t._v("äº‹åŠ¡Aåˆå¥‡æ€ªäº†ï¼Œæ˜æ˜åªæœ‰ä¸€æ¡æ•°æ®ï¼Œä¸ºå•¥å½±å“äº†ä¸¤æ¡æ•°æ®ğŸ˜­ï¼ˆ"),s("strong",[t._v("å¹»è¯»å‡ºç°")]),t._v("ï¼‰")]),t._v(" "),s("p",[t._v("é‚£ä¹ˆMySQLå¦‚ä½•è§£å†³å¹»è¯»å‘¢")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡A")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("äº‹åŠ¡B")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("start transaction;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept where id>=1 for update;"),s("br"),t._v("1,z"),s("br"),t._v("2,z")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("insert into dept values(3,'c');"),s("br"),t._v("Lock wait timeout exceeded; try restarting transaction")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("1,z"),s("br"),t._v("2,z")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("insert into dept values(3,'c');")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("commit;")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("select * from dept;"),s("br"),t._v("1,z"),s("br"),t._v("2,z"),s("br"),t._v("3,c")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),s("p",[t._v("å¯ä»¥çœ‹åˆ°é€šè¿‡å¯¹"),s("code",[t._v("id>=1")]),t._v("åŠ é”ï¼ŒæˆåŠŸè§£å†³å¹»è¯»é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœåœ¨é—´éš™é”ä¹‹å¤–è¿›è¡Œæ•°æ®æ“ä½œï¼Œå…¶å®è¿˜æ˜¯ä¼šå‡ºç°å¹»è¯»ã€‚å› æ­¤MySQLå¯é‡å¤è¯»éš”ç¦»çº§åˆ«é€šè¿‡é—´éš™é”éƒ¨åˆ†è§£å†³å¹»è¯»é—®é¢˜ï¼Œå¹¶æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œå¦‚æœè¦è§£å†³å¹»è¯»é—®é¢˜åªèƒ½ä½¿ç”¨ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ã€‚")])])}),[],!1,null,null,null);e.default=n.exports}}]);